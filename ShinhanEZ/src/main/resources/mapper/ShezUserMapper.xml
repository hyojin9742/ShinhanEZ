<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.shinhanez.mapper.ShezUserMapper">
    <!-- 기존 DB 평문 PW 암호화 | 임시 -->
    <select id="findAll" resultType="com.shinhanez.domain.ShezUser">
    	SELECT * FROM shez_user
    </select>
    <update id="updatePassword">
	    UPDATE shez_user
		SET pw = #{pw}
		WHERE id = #{id}
    </update>
    
    <!-- 회원가입 -->
    <insert id="insert" parameterType="ShezUser">
        INSERT INTO shez_user (id, pw, email, name, birth, telecom, gender, phone, nation, role, provider)
        VALUES (#{id}, #{pw}, #{email}, #{name}, #{birth}, #{telecom}, #{gender}, #{phone}, #{nation}, 'ROLE_USER', #{provider})
    </insert>
    
    <!-- 로그인 (ID, PW로 조회) -->
    <select id="findByIdAndPw" resultType="ShezUser">
        SELECT id, pw, email, name, birth, telecom, gender, phone, nation, role, reg_date as regDate
        FROM shez_user 
        WHERE id = #{id} AND pw = #{pw}
    </select>
    
    <!-- ID로 회원 조회 -->
    <select id="findById" resultType="ShezUser">
        SELECT id, pw, email, name, birth, telecom, gender, phone, nation, role, reg_date as regDate
        FROM shez_user 
        WHERE id = #{id}
    </select>
    
    <!-- ID 중복 체크 -->
    <select id="countById" resultType="int">
        SELECT COUNT(*) FROM shez_user WHERE id = #{id}
    </select>
    
    
    <!-- email로 회원 조회 -->
    <select id="findByEmail" resultType="ShezUser">
        SELECT id, pw, email, name, birth, telecom, gender, phone, nation, role, reg_date as regDate
        FROM shez_user 
        WHERE email = #{email}
    </select>
    
</mapper>
